<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>阵营数据同步解决方案</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        .header {
            background: #1a365d;
            color: white;
            padding: 20px;
            text-align: center;
        }
        .content {
            padding: 30px;
        }
        .card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #1a365d;
        }
        .btn {
            display: inline-block;
            padding: 12px 24px;
            background: #1a365d;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-align: center;
            text-decoration: none;
            margin: 10px 5px;
        }
        .btn:hover {
            background: #2d4a80;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        .step {
            display: flex;
            margin-bottom: 20px;
            align-items: flex-start;
        }
        .step-number {
            background: #1a365d;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            flex-shrink: 0;
            font-weight: bold;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            overflow-x: auto;
            margin: 15px 0;
            line-height: 1.5;
        }
        .note {
            background: #fffaf0;
            border-left: 4px solid #ecc94b;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .success {
            background: #f0fff4;
            border-left: 4px solid #38a169;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .error {
            background: #fff5f5;
            border-left: 4px solid #e53e3e;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .url-box {
            background: #edf2f7;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fa fa-database"></i> 阵营数据同步问题解决方案</h1>
            <p>解决GitHub数据同步问题，让所有人看到您的更改</p>
        </div>

        <div class="content">
            <div class="card">
                <h2><i class="fa fa-info-circle"></i> 问题分析</h2>
                <p>您已经将数据文件上传到GitHub，但其他人仍然看不到更改，这是因为：</p>
                
                <div class="error">
                    <p><strong>主要原因：</strong> 您的网站代码没有配置为从GitHub加载数据，而是使用本地存储的数据。</p>
                </div>
                
                <p>您提供的GitHub链接是仓库页面，但网站需要访问<strong>原始数据文件</strong>的URL。</p>
            </div>

            <div class="card">
                <h2><i class="fa fa-wrench"></i> 解决方案</h2>
                <p>要让所有人看到您的更改，您需要在网站代码中添加从GitHub加载数据的功能。</p>
                
                <div class="step">
                    <div class="step-number">1</div>
                    <div>
                        <p>获取GitHub原始数据文件的URL</p>
                        <p>根据您提供的信息，您的数据文件URL应该是：</p>
                        <div class="url-box">
                            https://raw.githubusercontent.com/5wdee/-/main/data/campaign-data.json
                        </div>
                        <p>请确认这个URL是否正确（点击测试）：</p>
                        <a href="https://raw.githubusercontent.com/5wdee/-/main/data/campaign-data.json" target="_blank" class="btn">
                            <i class="fa fa-external-link"></i> 测试数据URL
                        </a>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">2</div>
                    <div>
                        <p>在网站代码中添加数据加载功能</p>
                        <p>在您的JavaScript代码中，添加以下函数来从GitHub加载数据：</p>
                        <div class="code-block">
// 从GitHub加载数据
async function loadDataFromGitHub() {
    try {
        const response = await fetch('https://raw.githubusercontent.com/5wdee/-/main/data/campaign-data.json');
        if (!response.ok) {
            throw new Error('网络响应不正常');
        }
        const data = await response.json();
        return data;
    } catch (error) {
        console.error('加载数据失败:', error);
        // 失败时使用本地存储的数据
        return JSON.parse(localStorage.getItem('charactersData')) || defaultData;
    }
}

// 修改初始化函数
async function init() {
    // 尝试从GitHub加载数据
    const githubData = await loadDataFromGitHub();
    
    // 使用GitHub数据或回退到本地数据
    charactersData = githubData.characters || githubData;
    
    // 继续其他初始化操作
    renderCharacterCards();
    // ... 其他初始化代码
}
                        </div>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">3</div>
                    <div>
                        <p>修改您的保存函数，同时更新GitHub和本地存储</p>
                        <div class="code-block">
// 保存数据到GitHub（需要GitHub API权限）
async function saveDataToGitHub(data) {
    // 注意：这需要GitHub API和权限设置
    // 对于大多数情况，建议手动更新GitHub文件
    console.log('请手动更新GitHub上的数据文件');
    // 保存到本地存储作为备份
    localStorage.setItem('charactersData', JSON.stringify(data));
}

// 或者修改您的保存函数，提示用户手动更新GitHub
function saveDataToFile() {
    // ... 现有的下载代码
    
    // 添加提示
    alert('请将下载的campaign-data.json文件上传到您的GitHub仓库的data文件夹中');
}
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2><i class="fa fa-check-circle"></i> 即时解决方案</h2>
                <p>如果您不想修改代码，可以使用这个临时解决方案：</p>
                
                <div class="step">
                    <div class="step-number">1</div>
                    <div>
                        <p>在您的网站中添加一个"检查更新"按钮</p>
                        <div class="code-block">
// 添加一个检查更新的按钮
const updateButton = document.createElement('button');
updateButton.textContent = '检查数据更新';
updateButton.className = 'btn';
updateButton.onclick = checkForUpdates;
// 将按钮添加到页面中
document.body.appendChild(updateButton);

// 检查更新函数
async function checkForUpdates() {
    try {
        const response = await fetch('https://raw.githubusercontent.com/5wdee/-/main/data/campaign-data.json?t=' + new Date().getTime());
        if (!response.ok) return;
        
        const githubData = await response.json();
        // 与本地数据比较
        const localData = JSON.parse(localStorage.getItem('charactersData'));
        
        if (JSON.stringify(githubData) !== JSON.stringify(localData)) {
            if (confirm('发现新的数据更新，是否加载？')) {
                localStorage.setItem('charactersData', JSON.stringify(githubData));
                location.reload();
            }
        } else {
            alert('已经是最新数据');
        }
    } catch (error) {
        console.error('检查更新失败:', error);
    }
}
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2><i class="fa fa-life-ring"></i> 更多帮助</h2>
                <p>如果您需要更多帮助，可以提供以下信息：</p>
                
                <div class="note">
                    <ul>
                        <li>您的网站URL（如果已部署）</li>
                        <li>GitHub仓库的正确URL</li>
                        <li>数据文件的确切路径</li>
                        <li>您目前使用的数据加载方式</li>
                    </ul>
                </div>
                
                <p>您也可以考虑使用GitHub Pages直接部署您的网站，这样可以自动处理数据更新。</p>
                <a href="https://pages.github.com/" target="_blank" class="btn">
                    <i class="fa fa-github"></i> 了解GitHub Pages
                </a>
            </div>
        </div>
    </div>

    <script>
        // 示例代码 - 测试GitHub数据加载
        async function testGitHubData() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/5wdee/-/main/data/campaign-data.json');
                if (response.ok) {
                    const data = await response.json();
                    console.log('GitHub数据加载成功:', data);
                    alert('GitHub数据加载成功！您可以看到 ' + (data.characters ? Object.keys(data.characters).length : '未知') + ' 个阵营的数据。');
                } else {
                    alert('无法加载GitHub数据。请检查URL是否正确。');
                }
            } catch (error) {
                console.error('测试失败:', error);
                alert('测试失败: ' + error.message);
            }
        }
        
        // 添加测试按钮到页面
        document.addEventListener('DOMContentLoaded', function() {
            const testBtn = document.createElement('button');
            testBtn.textContent = '测试GitHub数据加载';
            testBtn.className = 'btn';
            testBtn.style.margin = '20px auto';
            testBtn.style.display = 'block';
            testBtn.onclick = testGitHubData;
            document.querySelector('.content').appendChild(testBtn);
        });
    </script>
</body>
</html>
